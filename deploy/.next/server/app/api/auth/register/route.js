"use strict";(()=>{var e={};e.id=3002,e.ids=[3002],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},27995:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>w,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var o={};t.r(o),t.d(o,{POST:()=>p});var a=t(49303),n=t(88716),s=t(60670),i=t(87070),l=t(42023),u=t(20728),c=t(9576);async function p(e){try{let{email:r,username:t,password:o,name:a,ageRange:n,role:s}=await e.json();if(!r||!t||!o)return i.NextResponse.json({error:"Email, username, and password are required"},{status:400});if(o.length<6)return i.NextResponse.json({error:"Password must be at least 6 characters"},{status:400});if(await u._.user.findUnique({where:{email:r}}))return i.NextResponse.json({error:"Email already registered"},{status:400});if(await u._.user.findUnique({where:{username:t}}))return i.NextResponse.json({error:"Username already taken"},{status:400});let p=await (0,l.hash)(o,12),d=(0,c.Z)().replace(/-/g,"")+(0,c.Z)().replace(/-/g,"");Date.now();let m=await u._.user.create({data:{email:r,username:t,password:p,name:a||t,role:"SUBSCRIBER"}}),g=`${process.env.NEXTAUTH_URL}/verify-email?token=${d}`;return console.log("=".repeat(60)),console.log("NEW USER VERIFICATION EMAIL"),console.log("=".repeat(60)),console.log(`To: ${m.email}`),console.log("Subject: Welcome to AI Media Tank - Verify your email"),console.log(""),console.log(`Hello ${m.name||m.username},`),console.log(""),console.log("Welcome to AI Media Tank! Please click the link below to verify your email:"),console.log(g),console.log(""),console.log("This link will expire in 24 hours."),console.log("=".repeat(60)),i.NextResponse.json({message:"User created successfully!",user:{id:m.id,email:m.email,username:m.username,role:m.role}})}catch(e){return console.error("Registration error:",e),i.NextResponse.json({error:"Something went wrong"},{status:500})}}let d=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"C:\\Users\\chong\\AI Studio\\aimediatank-azure\\src\\app\\api\\auth\\register\\route.ts",nextConfigOutput:"standalone",userland:o}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:h}=d,f="/api/auth/register/route";function w(){return(0,s.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}},9576:(e,r,t)=>{t.d(r,{Z:()=>u});var o=t(6113),a=t.n(o);let n={randomUUID:a().randomUUID},s=new Uint8Array(256),i=s.length,l=[];for(let e=0;e<256;++e)l.push((e+256).toString(16).slice(1));let u=function(e,r,t){if(n.randomUUID&&!r&&!e)return n.randomUUID();let o=(e=e||{}).random||(e.rng||function(){return i>s.length-16&&(a().randomFillSync(s),i=0),s.slice(i,i+=16)})();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,r){t=t||0;for(let e=0;e<16;++e)r[t+e]=o[e];return r}return function(e,r=0){return l[e[r+0]]+l[e[r+1]]+l[e[r+2]]+l[e[r+3]]+"-"+l[e[r+4]]+l[e[r+5]]+"-"+l[e[r+6]]+l[e[r+7]]+"-"+l[e[r+8]]+l[e[r+9]]+"-"+l[e[r+10]]+l[e[r+11]]+l[e[r+12]]+l[e[r+13]]+l[e[r+14]]+l[e[r+15]]}(o)}},20728:(e,r,t)=>{t.d(r,{_:()=>a});let o=require("@prisma/client"),a=globalThis.prisma??new o.PrismaClient}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[8948,5972,2023],()=>t(27995));module.exports=o})();