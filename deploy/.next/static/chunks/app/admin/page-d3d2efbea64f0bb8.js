(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{4519:function(e,s,t){Promise.resolve().then(t.bind(t,306))},6463:function(e,s,t){"use strict";var a=t(1169);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},306:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return c}});var a=t(7437),r=t(2265),l=t(998),d=t(6463),n=t(7138);function c(){let{data:e,status:s}=(0,l.useSession)(),t=(0,d.useRouter)(),[c,i]=(0,r.useState)("dashboard"),[o,m]=(0,r.useState)(null),[x,h]=(0,r.useState)([]),[u,p]=(0,r.useState)([]),[j,N]=(0,r.useState)([]),[f,g]=(0,r.useState)(!0);(0,r.useEffect)(()=>{var a;"unauthenticated"===s?t.push("/login"):"authenticated"===s&&(null==e?void 0:null===(a=e.user)||void 0===a?void 0:a.role)!=="ADMIN"&&t.push("/")},[s,e,t]),(0,r.useEffect)(()=>{var s;(null==e?void 0:null===(s=e.user)||void 0===s?void 0:s.role)==="ADMIN"&&v()},[e,c]);let v=async()=>{g(!0);try{if("dashboard"===c){let e=await fetch("/api/admin"),s=await e.json();m(s.stats)}else if("users"===c){let e=await fetch("/api/admin?action=users"),s=await e.json();h(s.users||[])}else if("media"===c){let e=await fetch("/api/admin?action=media"),s=await e.json();p(s.media||[])}else if("reports"===c){let e=await fetch("/api/admin?action=reports"),s=await e.json();N(s.reports||[])}}catch(e){console.error("Error fetching admin data:",e)}finally{g(!1)}},b=async(e,s,t)=>{if(confirm("Are you sure?"))try{(await fetch("/api/admin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:e,targetId:s,data:t})})).ok&&v()}catch(e){console.error("Error performing action:",e)}};return"loading"!==s&&(null==e?void 0:e.user)&&"ADMIN"===e.user.role?(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Admin Panel"}),(0,a.jsx)("p",{className:"text-gray-400 mb-8",children:"Manage users, content, and reports"}),(0,a.jsx)("div",{className:"flex gap-2 mb-8 overflow-x-auto no-scrollbar",children:["dashboard","users","media","reports"].map(e=>(0,a.jsx)("button",{onClick:()=>i(e),className:"px-4 py-2 rounded-xl font-medium whitespace-nowrap ".concat(c===e?"bg-tank-accent text-tank-black":"bg-tank-gray text-gray-400 hover:text-white"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))}),f?(0,a.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,a.jsx)("div",{className:"spinner"})}):(0,a.jsxs)(a.Fragment,{children:["dashboard"===c&&o&&(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"card text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-tank-accent",children:o.totalUsers}),(0,a.jsx)("div",{className:"text-gray-500",children:"Total Users"})]}),(0,a.jsxs)("div",{className:"card text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-blue-400",children:o.totalMedia}),(0,a.jsx)("div",{className:"text-gray-500",children:"Total Media"})]}),(0,a.jsxs)("div",{className:"card text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-purple-400",children:o.totalComments}),(0,a.jsx)("div",{className:"text-gray-500",children:"Comments"})]}),(0,a.jsxs)("div",{className:"card text-center",children:[(0,a.jsx)("div",{className:"text-3xl font-bold text-red-400",children:o.pendingReports}),(0,a.jsx)("div",{className:"text-gray-500",children:"Pending Reports"})]})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"font-semibold mb-4",children:"Media by Type"}),(0,a.jsx)("div",{className:"space-y-3",children:o.mediaByType.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"badge ".concat("VIDEO"===e.type?"badge-video":"IMAGE"===e.type?"badge-image":"badge-music"),children:e.type}),(0,a.jsx)("span",{className:"font-medium",children:e._count})]},e.type))})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"font-semibold mb-4",children:"Users by Role"}),(0,a.jsx)("div",{className:"space-y-3",children:o.usersByRole.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"badge ".concat("ADMIN"===e.role?"bg-red-500/20 text-red-400":"SUBSCRIBER"===e.role?"bg-tank-accent/20 text-tank-accent":"bg-gray-500/20 text-gray-400"),children:e.role}),(0,a.jsx)("span",{className:"font-medium",children:e._count})]},e.role))})]})]})]}),"users"===c&&(0,a.jsx)("div",{className:"card overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-tank-light",children:[(0,a.jsx)("th",{className:"text-left p-4 text-gray-400 font-medium",children:"User"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Email"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Role"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Media"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:x.map(e=>{var s,t;return(0,a.jsxs)("tr",{className:"border-b border-tank-light/50",children:[(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)(n.default,{href:"/profile/".concat(e.username),className:"flex items-center gap-3 hover:text-tank-accent",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-tank-accent to-purple-500 flex items-center justify-center text-xs font-bold",children:(null===(t=e.name)||void 0===t?void 0:null===(s=t[0])||void 0===s?void 0:s.toUpperCase())||e.username[0].toUpperCase()}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:e.name||e.username}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["@",e.username]})]})]})}),(0,a.jsx)("td",{className:"p-4 text-gray-400",children:e.email}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)("select",{value:e.role,onChange:s=>b("updateUserRole",e.id,{role:s.target.value}),className:"bg-tank-dark border border-tank-light rounded px-2 py-1 text-sm",children:[(0,a.jsx)("option",{value:"VIEWER",children:"VIEWER"}),(0,a.jsx)("option",{value:"SUBSCRIBER",children:"SUBSCRIBER"}),(0,a.jsx)("option",{value:"ADMIN",children:"ADMIN"})]})}),(0,a.jsx)("td",{className:"p-4",children:e._count.media}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsx)("button",{onClick:()=>b("deleteUser",e.id),className:"text-red-400 hover:text-red-300 text-sm",children:"Delete"})})]},e.id)})})]})}),"media"===c&&(0,a.jsx)("div",{className:"card overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b border-tank-light",children:[(0,a.jsx)("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Media"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Type"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Creator"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Status"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Reports"}),(0,a.jsx)("th",{className:"text-left p-4 text-gray-400 font-medium",children:"Actions"})]})}),(0,a.jsx)("tbody",{children:u.map(e=>(0,a.jsxs)("tr",{className:"border-b border-tank-light/50",children:[(0,a.jsx)("td",{className:"p-4",children:(0,a.jsx)(n.default,{href:"/media/".concat(e.id),className:"font-medium hover:text-tank-accent line-clamp-1",children:e.title})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsx)("span",{className:"badge ".concat("VIDEO"===e.type?"badge-video":"IMAGE"===e.type?"badge-image":"badge-music"),children:e.type})}),(0,a.jsxs)("td",{className:"p-4 text-gray-400",children:["@",e.user.username]}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsx)("span",{className:"badge ".concat(e.isApproved?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"),children:e.isApproved?"Approved":"Pending"})}),(0,a.jsx)("td",{className:"p-4",children:e._count.reports>0&&(0,a.jsx)("span",{className:"badge bg-red-500/20 text-red-400",children:e._count.reports})}),(0,a.jsx)("td",{className:"p-4",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[!e.isApproved&&(0,a.jsx)("button",{onClick:()=>b("approveMedia",e.id),className:"text-green-400 hover:text-green-300 text-sm",children:"Approve"}),e.isApproved&&(0,a.jsx)("button",{onClick:()=>b("rejectMedia",e.id),className:"text-yellow-400 hover:text-yellow-300 text-sm",children:"Reject"}),(0,a.jsx)("button",{onClick:()=>b("deleteMedia",e.id),className:"text-red-400 hover:text-red-300 text-sm",children:"Delete"})]})})]},e.id))})]})}),"reports"===c&&(0,a.jsx)("div",{className:"space-y-4",children:0===j.length?(0,a.jsx)("div",{className:"card text-center py-12 text-gray-500",children:"No pending reports"}):j.map(e=>(0,a.jsx)("div",{className:"card",children:(0,a.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("span",{className:"badge bg-red-500/20 text-red-400",children:"Report"}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["by @",e.user.username]})]}),(0,a.jsx)("p",{className:"text-gray-300 mb-2",children:e.reason}),(0,a.jsxs)(n.default,{href:"/media/".concat(e.media.id),className:"text-sm text-tank-accent hover:underline",children:["View: ",e.media.title]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Posted by @",e.media.user.username]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>b("resolveReport",e.id,{status:"RESOLVED"}),className:"btn-secondary text-sm py-2",children:"Resolve"}),(0,a.jsx)("button",{onClick:()=>b("resolveReport",e.id,{status:"DISMISSED"}),className:"text-gray-400 hover:text-gray-300 text-sm",children:"Dismiss"})]})]})},e.id))})]})]}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"spinner"})})}}},function(e){e.O(0,[998,138,971,23,744],function(){return e(e.s=4519)}),_N_E=e.O()}]);